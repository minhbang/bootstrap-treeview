!function($,e,t,o){"use strict";var s="treeview",n={};n.settings={injectStyle:!0,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"",selectedIcon:"",checkedIcon:"glyphicon glyphicon-check",uncheckedIcon:"glyphicon glyphicon-unchecked",color:o,backColor:o,borderColor:o,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:o,enableLinks:!1,enableTitles:!1,highlightSelected:!0,highlightSearchResults:!0,showBorder:!0,showIcon:!0,showCheckbox:!1,showTags:!1,multiSelect:!1,onNodeChecked:o,onNodeCollapsed:o,onNodeDisabled:o,onNodeEnabled:o,onNodeExpanded:o,onNodeSelected:o,onNodeUnchecked:o,onNodeUnselected:o,onSearchComplete:o,onSearchCleared:o},n.options={silent:!1,ignoreChildren:!1},n.searchOptions={ignoreCase:!0,exactMatch:!1,revealResults:!0};var i=function(e,t){return this.$element=$(e),this.elementId=e.id,this.styleId=this.elementId+"-style",this.init(t),{options:this.options,init:$.proxy(this.init,this),remove:$.proxy(this.remove,this),findNodes:$.proxy(this.findNodes,this),getNode:$.proxy(this.getNode,this),getParent:$.proxy(this.getParent,this),getSiblings:$.proxy(this.getSiblings,this),getSelected:$.proxy(this.getSelected,this),getUnselected:$.proxy(this.getUnselected,this),getExpanded:$.proxy(this.getExpanded,this),getCollapsed:$.proxy(this.getCollapsed,this),getChecked:$.proxy(this.getChecked,this),getUnchecked:$.proxy(this.getUnchecked,this),getDisabled:$.proxy(this.getDisabled,this),getEnabled:$.proxy(this.getEnabled,this),selectNode:$.proxy(this.selectNode,this),unselectNode:$.proxy(this.unselectNode,this),toggleNodeSelected:$.proxy(this.toggleNodeSelected,this),collapseAll:$.proxy(this.collapseAll,this),collapseNode:$.proxy(this.collapseNode,this),expandAll:$.proxy(this.expandAll,this),expandNode:$.proxy(this.expandNode,this),toggleNodeExpanded:$.proxy(this.toggleNodeExpanded,this),revealNode:$.proxy(this.revealNode,this),checkAll:$.proxy(this.checkAll,this),checkNode:$.proxy(this.checkNode,this),uncheckAll:$.proxy(this.uncheckAll,this),uncheckNode:$.proxy(this.uncheckNode,this),toggleNodeChecked:$.proxy(this.toggleNodeChecked,this),disableAll:$.proxy(this.disableAll,this),disableNode:$.proxy(this.disableNode,this),enableAll:$.proxy(this.enableAll,this),enableNode:$.proxy(this.enableNode,this),toggleNodeDisabled:$.proxy(this.toggleNodeDisabled,this),search:$.proxy(this.search,this),clearSearch:$.proxy(this.clearSearch,this)}};i.prototype.init=function(e){this.tree=[],this.nodes=[],e.data&&("string"==typeof e.data&&(e.data=$.parseJSON(e.data)),this.tree=$.extend(!0,[],e.data),delete e.data),this.options=$.extend({},n.settings,e),this.destroy(),this.subscribeEvents(),this.setInitialStates({nodes:this.tree},0),this.render()},i.prototype.remove=function(){this.destroy(),$.removeData(this,s),$("#"+this.styleId).remove()},i.prototype.destroy=function(){this.initialized&&(this.$wrapper.remove(),this.$wrapper=null,this.unsubscribeEvents(),this.initialized=!1)},i.prototype.unsubscribeEvents=function(){this.$element.off("click"),this.$element.off("nodeChecked"),this.$element.off("nodeCollapsed"),this.$element.off("nodeDisabled"),this.$element.off("nodeEnabled"),this.$element.off("nodeExpanded"),this.$element.off("nodeSelected"),this.$element.off("nodeUnchecked"),this.$element.off("nodeUnselected"),this.$element.off("searchComplete"),this.$element.off("searchCleared")},i.prototype.subscribeEvents=function(){this.unsubscribeEvents(),this.$element.on("click",$.proxy(this.clickHandler,this)),"function"==typeof this.options.onNodeChecked&&this.$element.on("nodeChecked",this.options.onNodeChecked),"function"==typeof this.options.onNodeCollapsed&&this.$element.on("nodeCollapsed",this.options.onNodeCollapsed),"function"==typeof this.options.onNodeDisabled&&this.$element.on("nodeDisabled",this.options.onNodeDisabled),"function"==typeof this.options.onNodeEnabled&&this.$element.on("nodeEnabled",this.options.onNodeEnabled),"function"==typeof this.options.onNodeExpanded&&this.$element.on("nodeExpanded",this.options.onNodeExpanded),"function"==typeof this.options.onNodeSelected&&this.$element.on("nodeSelected",this.options.onNodeSelected),"function"==typeof this.options.onNodeUnchecked&&this.$element.on("nodeUnchecked",this.options.onNodeUnchecked),"function"==typeof this.options.onNodeUnselected&&this.$element.on("nodeUnselected",this.options.onNodeUnselected),"function"==typeof this.options.onSearchComplete&&this.$element.on("searchComplete",this.options.onSearchComplete),"function"==typeof this.options.onSearchCleared&&this.$element.on("searchCleared",this.options.onSearchCleared)},i.prototype.setInitialStates=function(e,t){if(e.nodes){t+=1;var o=e,s=this;$.each(e.nodes,function n(e,i){i.nodeId=s.nodes.length,i.parentId=o.nodeId,i.hasOwnProperty("selectable")||(i.selectable=!0),i.state=i.state||{},i.state.hasOwnProperty("checked")||(i.state.checked=!1),i.state.hasOwnProperty("disabled")||(i.state.disabled=!1),i.state.hasOwnProperty("expanded")||(!i.state.disabled&&t<s.options.levels&&i.nodes&&i.nodes.length>0?i.state.expanded=!0:i.state.expanded=!1),i.state.hasOwnProperty("selected")||(i.state.selected=!1),s.nodes.push(i),i.nodes&&s.setInitialStates(i,t)})}},i.prototype.clickHandler=function(e){this.options.enableLinks||e.preventDefault();var t=$(e.target),o=this.findNode(t);if(o&&!o.state.disabled){var s=t.attr("class")?t.attr("class").split(" "):[];-1!==s.indexOf("expand-icon")?(this.toggleExpandedState(o,n.options),this.render()):-1!==s.indexOf("check-icon")?(this.toggleCheckedState(o,n.options),this.render()):(o.selectable?this.toggleSelectedState(o,n.options):this.toggleExpandedState(o,n.options),this.render())}},i.prototype.findNode=function(e){var t=e.closest("li.list-group-item").attr("data-nodeid"),o=this.nodes[t];return o||console.log("Error: node does not exist"),o},i.prototype.toggleExpandedState=function(e,t){e&&this.setExpandedState(e,!e.state.expanded,t)},i.prototype.setExpandedState=function(e,t,o){t!==e.state.expanded&&(t&&e.nodes?(e.state.expanded=!0,o.silent||this.$element.trigger("nodeExpanded",$.extend(!0,{},e))):t||(e.state.expanded=!1,o.silent||this.$element.trigger("nodeCollapsed",$.extend(!0,{},e)),e.nodes&&!o.ignoreChildren&&$.each(e.nodes,$.proxy(function(e,t){this.setExpandedState(t,!1,o)},this))))},i.prototype.toggleSelectedState=function(e,t){e&&this.setSelectedState(e,!e.state.selected,t)},i.prototype.setSelectedState=function(e,t,o){t!==e.state.selected&&(t?(this.options.multiSelect||$.each(this.findNodes("true","g","state.selected"),$.proxy(function(e,t){this.setSelectedState(t,!1,o)},this)),e.state.selected=!0,o.silent||this.$element.trigger("nodeSelected",$.extend(!0,{},e))):(e.state.selected=!1,o.silent||this.$element.trigger("nodeUnselected",$.extend(!0,{},e))))},i.prototype.toggleCheckedState=function(e,t){e&&this.setCheckedState(e,!e.state.checked,t)},i.prototype.setCheckedState=function(e,t,o){t!==e.state.checked&&(t?(e.state.checked=!0,o.silent||this.$element.trigger("nodeChecked",$.extend(!0,{},e))):(e.state.checked=!1,o.silent||this.$element.trigger("nodeUnchecked",$.extend(!0,{},e))))},i.prototype.setDisabledState=function(e,t,o){t!==e.state.disabled&&(t?(e.state.disabled=!0,this.setExpandedState(e,!1,o),this.setSelectedState(e,!1,o),this.setCheckedState(e,!1,o),o.silent||this.$element.trigger("nodeDisabled",$.extend(!0,{},e))):(e.state.disabled=!1,o.silent||this.$element.trigger("nodeEnabled",$.extend(!0,{},e))))},i.prototype.render=function(){this.initialized||(this.$element.addClass(s),this.$wrapper=$(this.template.list),this.injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.buildTree(this.tree,0)},i.prototype.buildTree=function(e,t){if(e){t+=1;var o=this;$.each(e,function s(e,n){var i=$(o.template.item).addClass("node-"+o.elementId).addClass(n.state.checked?"node-checked":"").addClass(n.state.disabled?"node-disabled":"").addClass(n.state.selected?"node-selected":"").addClass(n.searchResult?"search-result":"").attr("data-nodeid",n.nodeId).attr("style",o.buildStyleOverride(n));Object.keys(n).length>0&&$.each(n,function(e,t){e.match(/^data\-/)&&!e.match(/^data\-nodeid/)&&i.attr(e,t)}),o.options.enableTitles&&i.attr("title",n.text);for(var d=0;t-1>d;d++)i.append(o.template.indent);var r=[];return n.nodes?(r.push("expand-icon"),n.state.expanded?r.push(o.options.collapseIcon):r.push(o.options.expandIcon)):r.push(o.options.emptyIcon),i.append($(o.template.icon).addClass(r.join(" "))),o.options.showIcon&&(r=["node-icon"],r.push(n.icon||o.options.nodeIcon),n.state.selected&&(r.pop(),r.push(n.selectedIcon||o.options.selectedIcon||n.icon||o.options.nodeIcon)),i.append($(o.template.icon).addClass(r.join(" ")))),o.options.showCheckbox&&(r=["check-icon"],n.state.checked?r.push(o.options.checkedIcon):r.push(o.options.uncheckedIcon),i.append($(o.template.icon).addClass(r.join(" ")))),o.options.enableLinks?i.append($(o.template.link).attr("href",n.href).append(n.text)):i.append(n.text),o.options.showTags&&n.tags&&$.each(n.tags,function h(e,t){i.append($(o.template.badge).append(t))}),o.$wrapper.append(i),n.nodes&&n.state.expanded&&!n.state.disabled?o.buildTree(n.nodes,t):void 0})}},i.prototype.buildStyleOverride=function(e){if(e.state.disabled)return"";var t=e.color,o=e.backColor;return this.options.highlightSelected&&e.state.selected&&(this.options.selectedColor&&(t=this.options.selectedColor),this.options.selectedBackColor&&(o=this.options.selectedBackColor)),this.options.highlightSearchResults&&e.searchResult&&!e.state.disabled&&(this.options.searchResultColor&&(t=this.options.searchResultColor),this.options.searchResultBackColor&&(o=this.options.searchResultBackColor)),"color:"+t+";background-color:"+o+";"},i.prototype.injectStyle=function(){this.options.injectStyle&&!t.getElementById(this.styleId)&&$('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")},i.prototype.buildStyle=function(){var e=".node-"+this.elementId+"{";return this.options.color&&(e+="color:"+this.options.color+";"),this.options.backColor&&(e+="background-color:"+this.options.backColor+";"),this.options.showBorder?this.options.borderColor&&(e+="border:1px solid "+this.options.borderColor+";"):e+="border:none;",e+="}",this.options.onhoverColor&&(e+=".node-"+this.elementId+":not(.node-disabled):hover{background-color:"+this.options.onhoverColor+";}"),this.css+e},i.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'},i.prototype.css=".treeview .list-group-item{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.icon{width:12px;margin-right:5px}.treeview .node-disabled{color:silver;cursor:not-allowed}",i.prototype.getNode=function(e){return this.nodes[e]},i.prototype.getParent=function(e){var t=this.identifyNode(e);return this.nodes[t.parentId]},i.prototype.getSiblings=function(e){var t=this.identifyNode(e),o=this.getParent(t),s=o?o.nodes:this.tree;return s.filter(function(e){return e.nodeId!==t.nodeId})},i.prototype.getSelected=function(){return this.findNodes("true","g","state.selected")},i.prototype.getUnselected=function(){return this.findNodes("false","g","state.selected")},i.prototype.getExpanded=function(){return this.findNodes("true","g","state.expanded")},i.prototype.getCollapsed=function(){return this.findNodes("false","g","state.expanded")},i.prototype.getChecked=function(){return this.findNodes("true","g","state.checked")},i.prototype.getUnchecked=function(){return this.findNodes("false","g","state.checked")},i.prototype.getDisabled=function(){return this.findNodes("true","g","state.disabled")},i.prototype.getEnabled=function(){return this.findNodes("false","g","state.disabled")},i.prototype.selectNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setSelectedState(e,!0,t)},this)),this.render()},i.prototype.unselectNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setSelectedState(e,!1,t)},this)),this.render()},i.prototype.toggleNodeSelected=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.toggleSelectedState(e,t)},this)),this.render()},i.prototype.collapseAll=function(e){var t=this.findNodes("true","g","state.expanded");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},i.prototype.collapseNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setExpandedState(e,!1,t)},this)),this.render()},i.prototype.expandAll=function(e){if(e=$.extend({},n.options,e),e&&e.levels)this.expandLevels(this.tree,e.levels,e);else{var t=this.findNodes("false","g","state.expanded");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setExpandedState(e,!0,t)},this))}this.render()},i.prototype.expandNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setExpandedState(e,!0,t),e.nodes&&t&&t.levels&&this.expandLevels(e.nodes,t.levels-1,t)},this)),this.render()},i.prototype.expandLevels=function(e,t,o){o=$.extend({},n.options,o),$.each(e,$.proxy(function(e,s){this.setExpandedState(s,t>0?!0:!1,o),s.nodes&&this.expandLevels(s.nodes,t-1,o)},this))},i.prototype.revealNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){for(var o=this.getParent(e);o;)this.setExpandedState(o,!0,t),o=this.getParent(o)},this)),this.render()},i.prototype.toggleNodeExpanded=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.toggleExpandedState(e,t)},this)),this.render()},i.prototype.checkAll=function(e){var t=this.findNodes("false","g","state.checked");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},i.prototype.checkNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setCheckedState(e,!0,t)},this)),this.render()},i.prototype.uncheckAll=function(e){var t=this.findNodes("true","g","state.checked");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},i.prototype.uncheckNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setCheckedState(e,!1,t)},this)),this.render()},i.prototype.toggleNodeChecked=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.toggleCheckedState(e,t)},this)),this.render()},i.prototype.disableAll=function(e){var t=this.findNodes("false","g","state.disabled");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},i.prototype.disableNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setDisabledState(e,!0,t)},this)),this.render()},i.prototype.enableAll=function(e){var t=this.findNodes("true","g","state.disabled");this.forEachIdentifier(t,e,$.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},i.prototype.enableNode=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setDisabledState(e,!1,t)},this)),this.render()},i.prototype.toggleNodeDisabled=function(e,t){this.forEachIdentifier(e,t,$.proxy(function(e,t){this.setDisabledState(e,!e.state.disabled,t)},this)),this.render()},i.prototype.forEachIdentifier=function(e,t,o){t=$.extend({},n.options,t),e instanceof Array||(e=[e]),$.each(e,$.proxy(function(e,s){o(this.identifyNode(s),t)},this))},i.prototype.identifyNode=function(e){return"number"==typeof e?this.nodes[e]:e},i.prototype.search=function(e,t){t=$.extend({},n.searchOptions,t),this.clearSearch({render:!1});var o=[];if(e&&e.length>0){t.exactMatch&&(e="^"+e+"$");var s="g";t.ignoreCase&&(s+="i"),o=this.findNodes(e,s),$.each(o,function(e,t){t.searchResult=!0})}return t.revealResults?this.revealNode(o):this.render(),this.$element.trigger("searchComplete",$.extend(!0,{},o)),o},i.prototype.clearSearch=function(e){e=$.extend({},{render:!0},e);var t=$.each(this.findNodes("true","g","searchResult"),function(e,t){t.searchResult=!1});e.render&&this.render(),this.$element.trigger("searchCleared",$.extend(!0,{},t))},i.prototype.findNodes=function(e,t,o,s){t=t||"g",o=o||"text",s="undefined"!=typeof s?s:!0;var n=this;return $.grep(this.nodes,function(i){var d=n.getNodeValue(i,o);return"string"==typeof d?s?d.match(new RegExp(e,t)):d===e:void 0})},i.prototype.getNodeValue=function(e,t){var s=t.indexOf(".");if(s>0){var n=e[t.substring(0,s)],i=t.substring(s+1,t.length);return this.getNodeValue(n,i)}return e.hasOwnProperty(t)?e[t].toString():o};var d=function(t){e.console&&e.console.error(t)};$.fn[s]=function(e,t){var o;return this.each(function(){var n=$.data(this,s);"string"==typeof e?n?$.isFunction(n[e])&&"_"!==e.charAt(0)?(t instanceof Array||(t=[t]),o=n[e].apply(n,t)):d("No such method : "+e):d("Not initialized, can not call method : "+e):"boolean"==typeof e?o=n:$.data(this,s,new i(this,$.extend(!0,{},e)))}),o||this}}(jQuery,window,document);